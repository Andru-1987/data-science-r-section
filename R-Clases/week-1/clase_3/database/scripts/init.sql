DROP DATABASE IF EXISTS weather;
CREATE DATABASE weather;

CREATE TABLE `weather`.`cities`(
  id BIGINT PRIMARY KEY AUTO_INCREMENT ,
  name VARCHAR(100),
  country VARCHAR(100)
);

CREATE TABLE `weather`.`weather_data`(
  id INT PRIMARY KEY AUTO_INCREMENT,
  ozone INT,
  solar_r INT,
  wind DECIMAL(12,10),
  temp INT,
  month INT,
  day INT,
  city_id BIGINT);

ALTER TABLE `weather`.`weather_data`
ADD FOREIGN KEY (city_id) 
REFERENCES cities(id);



INSERT INTO
  `weather`.`cities` (name, country)
VALUES
  ('New York', 'USA'),
  ('Los Angeles', 'USA'),
  ('Chicago', 'USA'),
  ('Houston', 'USA'),
  ('Phoenix', 'USA');



INSERT INTO `weather`.`weather_data`
(ozone,solar_r,wind,temp,month,day,city_id)
VALUES
(41,190,7.4,67,5,1,FLOOR(RAND() * 5) + 1),
(36,118,8,72,5,2,FLOOR(RAND() * 5) + 1),
(12,149,12.6,74,5,3,FLOOR(RAND() * 5) + 1),
(18,313,11.5,62,5,4,FLOOR(RAND() * 5) + 1),
(NULL,NULL,14.3,56,5,5,FLOOR(RAND() * 5) + 1),
(28,NULL,14.9,66,5,6,FLOOR(RAND() * 5) + 1),
(23,299,8.6,65,5,7,FLOOR(RAND() * 5) + 1),
(19,99,13.8,59,5,8,FLOOR(RAND() * 5) + 1),
(8,19,20.1,61,5,9,FLOOR(RAND() * 5) + 1),
(NULL,194,8.6,69,5,10,FLOOR(RAND() * 5) + 1),
(7,NULL,6.9,74,5,11,FLOOR(RAND() * 5) + 1),
(16,256,9.7,69,5,12,FLOOR(RAND() * 5) + 1),
(11,290,9.2,66,5,13,FLOOR(RAND() * 5) + 1),
(14,274,10.9,68,5,14,FLOOR(RAND() * 5) + 1),
(18,65,13.2,58,5,15,FLOOR(RAND() * 5) + 1),
(14,334,11.5,64,5,16,FLOOR(RAND() * 5) + 1),
(34,307,12,66,5,17,FLOOR(RAND() * 5) + 1),
(6,78,18.4,57,5,18,FLOOR(RAND() * 5) + 1),
(30,322,11.5,68,5,19,FLOOR(RAND() * 5) + 1),
(11,44,9.7,62,5,20,FLOOR(RAND() * 5) + 1),
(1,8,9.7,59,5,21,FLOOR(RAND() * 5) + 1),
(11,320,16.6,73,5,22,FLOOR(RAND() * 5) + 1),
(4,25,9.7,61,5,23,FLOOR(RAND() * 5) + 1),
(32,92,12,61,5,24,FLOOR(RAND() * 5) + 1),
(NULL,66,16.6,57,5,25,FLOOR(RAND() * 5) + 1),
(NULL,266,14.9,58,5,26,FLOOR(RAND() * 5) + 1),
(NULL,NULL,8,57,5,27,FLOOR(RAND() * 5) + 1),
(23,13,12,67,5,28,FLOOR(RAND() * 5) + 1),
(45,252,14.9,81,5,29,FLOOR(RAND() * 5) + 1),
(115,223,5.7,79,5,30,FLOOR(RAND() * 5) + 1),
(37,279,7.4,76,5,31,FLOOR(RAND() * 5) + 1),
(NULL,286,8.6,78,6,1,FLOOR(RAND() * 5) + 1),
(NULL,287,9.7,74,6,2,FLOOR(RAND() * 5) + 1),
(NULL,242,16.1,67,6,3,FLOOR(RAND() * 5) + 1),
(NULL,186,9.2,84,6,4,FLOOR(RAND() * 5) + 1),
(NULL,220,8.6,85,6,5,FLOOR(RAND() * 5) + 1),
(NULL,264,14.3,79,6,6,FLOOR(RAND() * 5) + 1),
(29,127,9.7,82,6,7,FLOOR(RAND() * 5) + 1),
(NULL,273,6.9,87,6,8,FLOOR(RAND() * 5) + 1),
(71,291,13.8,90,6,9,FLOOR(RAND() * 5) + 1),
(39,323,11.5,87,6,10,FLOOR(RAND() * 5) + 1),
(NULL,259,10.9,93,6,11,FLOOR(RAND() * 5) + 1),
(NULL,250,9.2,92,6,12,FLOOR(RAND() * 5) + 1),
(23,148,8,82,6,13,FLOOR(RAND() * 5) + 1),
(NULL,332,13.8,80,6,14,FLOOR(RAND() * 5) + 1),
(NULL,322,11.5,79,6,15,FLOOR(RAND() * 5) + 1),
(21,191,14.9,77,6,16,FLOOR(RAND() * 5) + 1),
(37,284,20.7,72,6,17,FLOOR(RAND() * 5) + 1),
(20,37,9.2,65,6,18,FLOOR(RAND() * 5) + 1),
(12,120,11.5,73,6,19,FLOOR(RAND() * 5) + 1),
(13,137,10.3,76,6,20,FLOOR(RAND() * 5) + 1),
(NULL,150,6.3,77,6,21,FLOOR(RAND() * 5) + 1),
(NULL,59,1.7,76,6,22,FLOOR(RAND() * 5) + 1),
(NULL,91,4.6,76,6,23,FLOOR(RAND() * 5) + 1),
(NULL,250,6.3,76,6,24,FLOOR(RAND() * 5) + 1),
(NULL,135,8,75,6,25,FLOOR(RAND() * 5) + 1),
(NULL,127,8,78,6,26,FLOOR(RAND() * 5) + 1),
(NULL,47,10.3,73,6,27,FLOOR(RAND() * 5) + 1),
(NULL,98,11.5,80,6,28,FLOOR(RAND() * 5) + 1),
(NULL,31,14.9,77,6,29,FLOOR(RAND() * 5) + 1),
(NULL,138,8,83,6,30,FLOOR(RAND() * 5) + 1),
(135,269,4.1,84,7,1,FLOOR(RAND() * 5) + 1),
(49,248,9.2,85,7,2,FLOOR(RAND() * 5) + 1),
(32,236,9.2,81,7,3,FLOOR(RAND() * 5) + 1),
(NULL,101,10.9,84,7,4,FLOOR(RAND() * 5) + 1),
(64,175,4.6,83,7,5,FLOOR(RAND() * 5) + 1),
(40,314,10.9,83,7,6,FLOOR(RAND() * 5) + 1),
(77,276,5.1,88,7,7,FLOOR(RAND() * 5) + 1),
(97,267,6.3,92,7,8,FLOOR(RAND() * 5) + 1),
(97,272,5.7,92,7,9,FLOOR(RAND() * 5) + 1),
(85,175,7.4,89,7,10,FLOOR(RAND() * 5) + 1),
(NULL,139,8.6,82,7,11,FLOOR(RAND() * 5) + 1),
(10,264,14.3,73,7,12,FLOOR(RAND() * 5) + 1),
(27,175,14.9,81,7,13,FLOOR(RAND() * 5) + 1),
(NULL,291,14.9,91,7,14,FLOOR(RAND() * 5) + 1),
(7,48,14.3,80,7,15,FLOOR(RAND() * 5) + 1),
(48,260,6.9,81,7,16,FLOOR(RAND() * 5) + 1),
(35,274,10.3,82,7,17,FLOOR(RAND() * 5) + 1),
(61,285,6.3,84,7,18,FLOOR(RAND() * 5) + 1),
(79,187,5.1,87,7,19,FLOOR(RAND() * 5) + 1),
(63,220,11.5,85,7,20,FLOOR(RAND() * 5) + 1),
(16,7,6.9,74,7,21,FLOOR(RAND() * 5) + 1),
(NULL,258,9.7,81,7,22,FLOOR(RAND() * 5) + 1),
(NULL,295,11.5,82,7,23,FLOOR(RAND() * 5) + 1),
(80,294,8.6,86,7,24,FLOOR(RAND() * 5) + 1),
(108,223,8,85,7,25,FLOOR(RAND() * 5) + 1),
(20,81,8.6,82,7,26,FLOOR(RAND() * 5) + 1),
(52,82,12,86,7,27,FLOOR(RAND() * 5) + 1),
(82,213,7.4,88,7,28,FLOOR(RAND() * 5) + 1),
(50,275,7.4,86,7,29,FLOOR(RAND() * 5) + 1),
(64,253,7.4,83,7,30,FLOOR(RAND() * 5) + 1),
(59,254,9.2,81,7,31,FLOOR(RAND() * 5) + 1),
(39,83,6.9,81,8,1,FLOOR(RAND() * 5) + 1),
(9,24,13.8,81,8,2,FLOOR(RAND() * 5) + 1),
(16,77,7.4,82,8,3,FLOOR(RAND() * 5) + 1),
(78,NULL,6.9,86,8,4,FLOOR(RAND() * 5) + 1),
(35,NULL,7.4,85,8,5,FLOOR(RAND() * 5) + 1),
(66,NULL,4.6,87,8,6,FLOOR(RAND() * 5) + 1),
(122,255,4,89,8,7,FLOOR(RAND() * 5) + 1),
(89,229,10.3,90,8,8,FLOOR(RAND() * 5) + 1),
(110,207,8,90,8,9,FLOOR(RAND() * 5) + 1),
(NULL,222,8.6,92,8,10,FLOOR(RAND() * 5) + 1),
(NULL,137,11.5,86,8,11,FLOOR(RAND() * 5) + 1),
(44,192,11.5,86,8,12,FLOOR(RAND() * 5) + 1),
(28,273,11.5,82,8,13,FLOOR(RAND() * 5) + 1),
(65,157,9.7,80,8,14,FLOOR(RAND() * 5) + 1),
(NULL,64,11.5,79,8,15,FLOOR(RAND() * 5) + 1),
(22,71,10.3,77,8,16,FLOOR(RAND() * 5) + 1),
(59,51,6.3,79,8,17,FLOOR(RAND() * 5) + 1),
(23,115,7.4,76,8,18,FLOOR(RAND() * 5) + 1),
(31,244,10.9,78,8,19,FLOOR(RAND() * 5) + 1),
(44,190,10.3,78,8,20,FLOOR(RAND() * 5) + 1),
(21,259,15.5,77,8,21,FLOOR(RAND() * 5) + 1),
(9,36,14.3,72,8,22,FLOOR(RAND() * 5) + 1),
(NULL,255,12.6,75,8,23,FLOOR(RAND() * 5) + 1),
(45,212,9.7,79,8,24,FLOOR(RAND() * 5) + 1),
(168,238,3.4,81,8,25,FLOOR(RAND() * 5) + 1),
(73,215,8,86,8,26,FLOOR(RAND() * 5) + 1),
(NULL,153,5.7,88,8,27,FLOOR(RAND() * 5) + 1),
(76,203,9.7,97,8,28,FLOOR(RAND() * 5) + 1),
(118,225,2.3,94,8,29,FLOOR(RAND() * 5) + 1),
(84,237,6.3,96,8,30,FLOOR(RAND() * 5) + 1),
(85,188,6.3,94,8,31,FLOOR(RAND() * 5) + 1),
(96,167,6.9,91,9,1,FLOOR(RAND() * 5) + 1),
(78,197,5.1,92,9,2,FLOOR(RAND() * 5) + 1),
(73,183,2.8,93,9,3,FLOOR(RAND() * 5) + 1),
(91,189,4.6,93,9,4,FLOOR(RAND() * 5) + 1),
(47,95,7.4,87,9,5,FLOOR(RAND() * 5) + 1),
(32,92,15.5,84,9,6,FLOOR(RAND() * 5) + 1),
(20,252,10.9,80,9,7,FLOOR(RAND() * 5) + 1),
(23,220,10.3,78,9,8,FLOOR(RAND() * 5) + 1),
(21,230,10.9,75,9,9,FLOOR(RAND() * 5) + 1),
(24,259,9.7,73,9,10,FLOOR(RAND() * 5) + 1),
(44,236,14.9,81,9,11,FLOOR(RAND() * 5) + 1),
(21,259,15.5,76,9,12,FLOOR(RAND() * 5) + 1),
(28,238,6.3,77,9,13,FLOOR(RAND() * 5) + 1),
(9,24,10.9,71,9,14,FLOOR(RAND() * 5) + 1),
(13,112,11.5,71,9,15,FLOOR(RAND() * 5) + 1),
(46,237,6.9,78,9,16,FLOOR(RAND() * 5) + 1),
(18,224,13.8,67,9,17,FLOOR(RAND() * 5) + 1),
(13,27,10.3,76,9,18,FLOOR(RAND() * 5) + 1),
(24,238,10.3,68,9,19,FLOOR(RAND() * 5) + 1),
(16,201,8,82,9,20,FLOOR(RAND() * 5) + 1),
(13,238,12.6,64,9,21,FLOOR(RAND() * 5) + 1),
(23,14,9.2,71,9,22,FLOOR(RAND() * 5) + 1),
(36,139,10.3,81,9,23,FLOOR(RAND() * 5) + 1),
(7,49,10.3,69,9,24,FLOOR(RAND() * 5) + 1),
(14,20,16.6,63,9,25,FLOOR(RAND() * 5) + 1),
(30,193,6.9,70,9,26,FLOOR(RAND() * 5) + 1),
(NULL,145,13.2,77,9,27,FLOOR(RAND() * 5) + 1),
(14,191,14.3,75,9,28,FLOOR(RAND() * 5) + 1),
(18,131,8,76,9,29,FLOOR(RAND() * 5) + 1),
(20,223,11.5,68,9,30,FLOOR(RAND() * 5) + 1);